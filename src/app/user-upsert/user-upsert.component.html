<!-- user-upsert.component.html -->
<div class="loader-container" *ngIf="isLoading">
    <div class="lds-ellipsis">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
    </div>
</div>
<!-- Your form -->
<div class="container-fluid" *ngIf="!isLoading">
    <div class="row outline">
        <app-primary-nav class="outline"></app-primary-nav>
    </div>
    <div class="row">
        <div class="col-sm-3 outline" style="height: 100vw;background-color: #E5C397;">
            <app-secondary-nav></app-secondary-nav>
        </div>
        <div class="col-sm-9" style="background-image: url('../../assets/back.jpg');background-repeat: no-repeat;  background-attachment: fixed;
        background-size: cover;">
            <div style="text-align: center;
            margin-top: 10%;color: white;">
                <h5 *ngIf="!isEdit" style="font-size: 35px;">
                    Create New User
                </h5>
                <h5 *ngIf="isEdit"  style="font-size: 35px;">
                    Edit user {{ userForm.get('name.firstname')?.value }}
                </h5>
            </div>
            <div class="container custom-form">

                <div>
                    <i class="fa-solid fa-user mr-3  fa-xl" style="position: absolute;top: 25px ;"></i>
                    <i class="fa-solid fa-city mr-3  fa-xl" style="position: absolute;top: 25px ;
                    left: 48%;"></i>
                    <i class="fa-solid fa-address-card  mr-3  fa-xl" style="
                    position: absolute;top: 25px ;
                    right: 10px;"></i>
                </div>
                <div style="margin-top: 35px;">
                    <mat-progress-bar mode="determinate" [value]="progress"></mat-progress-bar>
                </div>
                <div>
                    <form [formGroup]="userForm" class="form-group mt-3" (ngSubmit)="onSubmit()">
                        <!-- Step 1 -->
                        <div formGroupName="name" *ngIf="currentStep === 1" class="form-group">
                            <label for="firstname">First Name:</label>
                            <input type="text" id="firstname" formControlName="firstname" class="form-control" (click)="firstNameRequired = true"/>
                            <div *ngIf="firstNameRequired && userForm.get('name.firstname')?.hasError('required')" class="error-message">
                                *First name is required.
                            </div>
                            <label for="lastname">Last Name:</label>
                            <input type="text" id="lastname" formControlName="lastname" class="form-control" (click)="lastNameRequired  = true" />
                            <div *ngIf="lastNameRequired && userForm.get('name.lastname')?.hasError('required')" class="error-message">
                                *Last name is required.
                            </div>
                        </div>

                        <!-- Step 2 -->
                        <div formGroupName="address" class="form-group" *ngIf="currentStep === 2">
                            <label for="city">City:</label>
                            <input type="text" id="city" formControlName="city" class="form-control" (click)="cityNameRequired = true"/>
                            <div *ngIf=" cityNameRequired && userForm.get('address.city')?.hasError('required')" class="error-message">
                                *city name is required.
                            </div>
                            <label for="street">Street:</label>
                            <input type="text" id="street" formControlName="street" class="form-control" (click)="streetNameRequired = true"/>
                            <div *ngIf="streetNameRequired && userForm.get('address.street')?.hasError('required')" class="error-message">
                                *Street name is required.
                            </div>
                        </div>

                        <!-- Step 3 -->
                        <div *ngIf="currentStep === 3">
                            <label for="email">Email:</label>
                            <input class="form-control" type="email" id="email" formControlName="email" (click)="emailRequired = true"/>
                            <div *ngIf="emailRequired && userForm.get('email')?.hasError('required')" class="error-message">
                                *Email is required.
                            </div>
                            <div *ngIf="userForm.get('email')?.hasError('email')" class="error-message">
                                *Please enter a valid email address.
                            </div>

                            <label for="phone">Phone:</label>
                            <input class="form-control" type="text" id="phone" formControlName="phone" (click)="phoneRequired = true" (keyup)="onPhoneNumberInput($event)" />
                            <div *ngIf="phoneRequired && userForm.get('phone')?.hasError('required')" class="error-message">
                                *Phone is required.
                            </div>
                            <div *ngIf="userForm.get('phone')?.hasError('pattern')" class="error-message">
                                *Please enter a valid phone number.
                            </div>
                        </div>

                        <div class="navigation-buttons" style="display: flex;
                        justify-content: space-between;margin-top: 55px;">
                            <div>
                                <button type="button" (click)="previousStep()" *ngIf="currentStep > 1" class="navbtn">
                                    &laquo; Previous</button>
                                <button type="button" (click)="nextStep()" *ngIf="currentStep < 3" class="navbtn">Next
                                    &raquo;</button>
                            </div>

                            <button type="submit" *ngIf="currentStep === 3"
                                class="cssbuttons-io-button cssbuttons-io-button-sure">Submit
                                <div class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path
                                            d="M16.172 11l-5.364-5.364 1.414-1.414L20 12l-7.778 7.778-1.414-1.414L16.172 13H4v-2z"
                                            fill="currentColor"></path>
                                    </svg>
                                </div>
                            </button>
                        </div>
                    </form>

                    <!-- <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="container mt-5">
                        <div formGroupName="name" class="form-group">
                            <label for="firstname">First Name:</label>
                            <input type="text" id="firstname" formControlName="firstname" class="form-control" />
                            <div *ngIf="userForm.get('name.firstname')??.hasError('required')">
                                First name is required.
                            </div>
                            <label for="lastname">Last Name:</label>
                            <input type="text" id="lastname" formControlName="lastname" class="form-control" />
                            <div *ngIf="userForm.get('name.lastname')??.hasError('required')">
                                Last name is required.
                            </div>
                        </div>

                        <div formGroupName="address" class="form-group">
                            <label for="city">City:</label>
                            <input type="text" id="city" formControlName="city" class="form-control" />
                            <div *ngIf="userForm.get('address.city')??.hasError('required')">
                                city name is required.
                            </div>
                            <label for="street">Street:</label>
                            <input type="text" id="street" formControlName="street" class="form-control" />
                            <div *ngIf="userForm.get('address.street')??.hasError('required')">
                                Street name is required.
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="email">Email:</label>
                            <input type="email" id="email" formControlName="email" class="form-control" />
                            <div *ngIf="userForm.get('email')??.hasError('required')">
                                Email is required.
                            </div>
                            <div *ngIf="userForm.get('email')??.hasError('pattern')">
                                Please enter a valid email address.
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="phone">Phone Number:</label>
                            <input type="text" (keyup)="onPhoneNumberInput($event)" id="phone" formControlName="phone"
                                class="form-control" />
                            <div *ngIf="userForm.get('phone')??.hasError('required')">
                                Phone number is required.
                            </div>
                            <div *ngIf="userForm.get('phone')??.hasError('pattern')">
                                Please enter a valid phone number.
                            </div>
                        </div>
                        <div style="margin-top: 20px;">
                            <button type="submit" [disabled]="userForm.invalid" class="btn btn-primary">Submit</button>
                        </div>
                    </form> -->
                </div>

            </div>
        </div>
    </div>
</div>